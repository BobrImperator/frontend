{{! template-lint-disable attribute-indentation }}
<div class="course-overview-header">
  <div class="title">
    {{t "general.overview"}}
  </div>
  <div class="course-overview-actions">
    <LinkTo @route="course-materials" @model={{@course}} class="materials">
      <FaIcon
        @icon="archive"
        @title={{t "general.learningMaterialsSummary"}}
        @fixedWidth={{true}}
      />
    </LinkTo>
    <LinkTo
      @route="print_course"
      @model={{@course}}
      @query={{hash unpublished=true}}
      class="print"
    >
      <FaIcon
        @icon="print"
        @title={{t "general.printSummary"}}
        @fixedWidth={{true}}
      />
    </LinkTo>
    {{#if (and (is-fulfilled this.showRollover) (await this.showRollover))}}
      <span
        class="clickable rollover"
        role="button"
        {{on "click" (action "transitionToRollover")}}
      >
        <FaIcon
          @icon="random"
          @fixedWidth={{true}}
          @title={{t "general.courseRollover"}}
        />
      </span>
    {{/if}}
    <LinkTo
      @route="course-visualizations"
      @model={{@course}}
      @title={{t "general.courseVisualizations"}}
    >
      <FaIcon @icon="chart-bar" />
    </LinkTo>
  </div>
</div>
<div class="course-overview-content">
  <div class="block courseexternalid">
    <label>{{t "general.externalId"}}:</label>
    <span>
      {{#if @editable}}
        <EditableField
          @value={{if this.externalId this.externalId (t "general.clickToEdit")}}
          @save={{action "changeExternalId"}}
          @close={{action "revertExternalIdChanges"}}
          @saveOnEnter={{true}}
          @closeOnEscape={{true}} as |isSaving|
        >
          <input
            type="text"
            value={{this.externalId}}
            disabled={{isSaving}}
            {{on "input" (action (mut this.externalId) value="target.value")}}
            {{on "keyup" (fn (action "addErrorDisplayFor") "externalId")}}
          >
          {{#if
            (and
              (v-get this "externalId" "isInvalid")
              (is-in this.showErrorsFor "externalId")
            )
          }}
            <span class="validation-error-message">
              {{v-get this "externalId" "message"}}
            </span>
          {{/if}}
        </EditableField>
      {{else}}
        {{this.externalId}}&nbsp;
      {{/if}}
    </span>
  </div>
  <div class="block clerkshiptype">
    <label>{{t "general.clerkshipType"}}:</label>
    <span>
      {{#if @editable}}
        <EditableField
          @value={{await this.clerkshipTypeTitle}}
          @save={{action "changeClerkshipType"}}
          @close={{action "revertClerkshipTypeChanges"}}
        >
          <select {{on "change" (action "setCourseClerkshipType" value="target.value")}}>
            <option
              value="null"
              selected={{is-empty (await this.selectedClerkshipType)}}
            >
              {{t "general.notAClerkship"}}
            </option>
            {{#each
              (sort-by "title" (await this.clerkshipTypeOptions)) as |clerkshipType|
            }}
              <option
                value={{clerkshipType.id}}
                selected={{is-equal clerkshipType (await this.selectedClerkshipType)
                }}
              >
                {{clerkshipType.title}}
              </option>
            {{/each}}
          </select>
        </EditableField>
      {{else if @course.clerkshipType}}
        {{@course.clerkshipType.title}}
      {{else}}
        {{t "general.notAClerkship"}}
      {{/if}}
    </span>
  </div>
  <div class="block coursestartdate">
    <label>{{t "general.start"}}:</label>
    <span>
      {{#if @editable}}
        <EditableField
          @value={{moment-format @course.startDate "L"}}
          @save={{action "changeStartDate"}}
          @close={{action "revertStartDateChanges"}}
        >
          <PikadayInput
            @value={{this.startDate}}
            @format="L"
            @onSelection={{action (mut this.startDate)}}
            @focusOut={{action "addErrorDisplayFor" "startDate"}}
          />
          {{#if
            (and
              (v-get this "startDate" "isInvalid")
              (is-in this.showErrorsFor "startDate")
            )
          }}
            <span class="validation-error-message">
              {{v-get this "startDate" "message"}}
            </span>
          {{/if}}
        </EditableField>
      {{else}}
        {{moment-format @course.startDate "L"}}&nbsp;
      {{/if}}
    </span>
  </div>
  <div class="block courseenddate">
    <label>{{t "general.end"}}:</label>
    <span>
      {{#if @editable}}
        <EditableField
          @value={{moment-format @course.endDate "L"}}
          @save={{action "changeEndDate"}}
          @close={{action "revertEndDateChanges"}}
        >
          <PikadayInput
            @value={{this.endDate}}
            @format="L"
            @onSelection={{action (mut this.endDate)}}
            @focusOut={{action "addErrorDisplayFor" "endDate"}}
          />
          {{#if
            (and
              (v-get this "endDate" "isInvalid") (is-in this.showErrorsFor "endDate")
            )
          }}
            <span class="validation-error-message">
              {{v-get this "endDate" "message"}}
            </span>
          {{/if}}
        </EditableField>
      {{else}}
        {{moment-format @course.endDate "L"}}&nbsp;
      {{/if}}
    </span>
  </div>
  <div class="block courselevel">
    <label>{{t "general.level"}}:</label>
    <span>
      {{#if @editable}}
        <EditableField
          @value={{this.level}}
          @save={{action "changeLevel"}}
          @close={{action "revertLevelChanges"}}
        >
          {{one-way-select
            this.level
            options=this.levelOptions
            optionTargetPath="id"
            optionLabelPath="title"
            update=(action (mut this.level))
          }}
        </EditableField>
      {{else}}
        {{this.level}}&nbsp;
      {{/if}}
    </span>
  </div>
  <div class="block">
    <label>{{t "general.universalLocator"}}:</label>
    <span class="universallocator">
      <strong>
        {{concat this.universalLocator @course.id}}
      </strong>
    </span>
  </div>
</div>
