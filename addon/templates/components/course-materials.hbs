<div class="material-list">
  <h3>
    {{t "general.courseLearningMaterials"}} ({{get (await this.course.learningMaterials) "length"}})
  </h3>
  <span class="filter-course-lms">
    <input
      placeholder={{t "general.filterPlaceholder"}}
      value={{this.courseQuery}}
      oninput={{perform this.setCourseQuery value="target.value"}}
    >
  </span>
  <table data-test-course-table>
    <thead>
      <tr>
        <SortableTh
          @colspan={{4}}
          @sortedAscending={{this.clmSortedAscending}}
          @sortedBy={{or (eq this.courseSort "title") (eq this.courseSort "title:desc")
          }}
          @click={{action "courseSortBy" "title"}}
        >
          {{t "general.title"}}
        </SortableTh>
        <SortableTh
          @sortedAscending={{this.clmSortedAscending}}
          @sortedBy={{or (eq this.courseSort "type") (eq this.courseSort "type:desc")}}
          @click={{action "courseSortBy" "type"}}
        >
          {{t "general.type"}}
        </SortableTh>
        <SortableTh
          @sortedAscending={{this.clmSortedAscending}}
          @sortedBy={{or
            (eq this.courseSort "author")
            (eq this.courseSort "author:desc")
          }}
          @click={{action "courseSortBy" "author"}}
        >
          {{t "general.author"}}
        </SortableTh>
      </tr>
    </thead>
    <tbody>
      {{#if (is-pending this.courseLearningMaterialObjects)}}
        <tr>
          <td colspan="6" align="center">
            <FaIcon @icon="spinner" class="orange" @size="2x" @spin={{true}} />
          </td>
        </tr>
      {{else}}
        {{#each
          (sort-by
            this.courseSort (await this.filteredCourseLearningMaterialObjects)
          ) as |lmObject|
        }}
          <tr>
            <td colspan="4">
              {{#if (contains lmObject.type this.typesWithUrl)}}
                <a href={{lmObject.url}} rel="noopener" target="_blank">
                  {{lmObject.title}}
                </a>
              {{else}}
                {{lmObject.title}}
                <br>
                <small>
                  {{lmObject.citation}}
                </small>
              {{/if}}
            </td>
            <td>
              {{capitalize lmObject.type}}
            </td>
            <td>
              {{lmObject.author}}
            </td>
          </tr>
        {{else}}
          <tr>
            <td colspan="6" align="center">
              {{if
                this.courseQuery
                (t "general.noResultsFound")
                (t "general.noCourseLearningMaterialsAvailable")
              }}
            </td>
          </tr>
        {{/each}}
      {{/if}}
    </tbody>
  </table>
</div>
<div class="material-list">
  <h3 class="session-material-title">
    {{t "general.sessionLearningMaterials"}} ({{get (await this.sessionLearningMaterialObjects) "length"}})
  </h3>
  <span class="filter-session-lms">
    <input
      placeholder={{t "general.filterPlaceholder"}}
      value={{this.sessionQuery}}
      oninput={{perform this.setSessionQuery value="target.value"}}
    >
  </span>
  <table data-test-session-table>
    <thead>
      <tr>
        <SortableTh
          @colspan={{3}}
          @sortedAscending={{this.slmSortedAscending}}
          @sortedBy={{or
            (eq this.sessionSort "title")
            (eq this.sessionSort "title:desc")
          }}
          @click={{action "sessionSortBy" "title"}}
        >
          {{t "general.title"}}
        </SortableTh>
        <SortableTh
          @colspan={{1}}
          @sortedAscending={{this.slmSortedAscending}}
          @sortedBy={{or (eq this.sessionSort "type") (eq this.sessionSort "type:desc")
          }}
          @click={{action "sessionSortBy" "type"}}
        >
          {{t "general.type"}}
        </SortableTh>
        <SortableTh
          @colspan={{1}}
          @sortedAscending={{this.slmSortedAscending}}
          @sortedBy={{or
            (eq this.sessionSort "author")
            (eq this.sessionSort "author:desc")
          }}
          @click={{action "sessionSortBy" "author"}}
        >
          {{t "general.author"}}
        </SortableTh>
        <SortableTh
          @colspan={{3}}
          @sortedAscending={{this.slmSortedAscending}}
          @sortedBy={{or
            (eq this.sessionSort "sessionTitle")
            (eq this.sessionSort "sessionTitle:desc")
          }}
          @click={{action "sessionSortBy" "sessionTitle"}}
        >
          {{t "general.session"}}
        </SortableTh>
        <SortableTh
          @colspan={{1}}
          @sortedAscending={{this.slmSortedAscending}}
          @sortedBy={{or
            (eq this.sessionSort "firstOfferingDate")
            (eq this.sessionSort "firstOfferingDate:desc")
          }}
          @sortType="numeric"
          @click={{action "sessionSortBy" "firstOfferingDate"}}
        >
          {{t "general.firstOffering"}}
        </SortableTh>
      </tr>
    </thead>
    <tbody>
      {{#if (is-pending this.sessionLearningMaterialObjects)}}
        <tr>
          <td colspan="9" align="center">
            <FaIcon @icon="spinner" class="orange" @size="2x" @spin={{true}} />
          </td>
        </tr>
      {{else}}
        {{#each
          (sort-by
            this.sessionSort (await this.filteredSessionLearningMaterialObjects)
          ) as |lmObject|
        }}
          <tr>
            <td colspan="3">
              {{#if (contains lmObject.type this.typesWithUrl)}}
                <a href={{lmObject.url}} rel="noopener" target="_blank">
                  {{lmObject.title}}
                </a>
              {{else}}
                {{lmObject.title}}
                <br>
                <small>
                  {{lmObject.citation}}
                </small>
              {{/if}}
            </td>
            <td>
              {{capitalize lmObject.type}}
            </td>
            <td>
              {{lmObject.author}}
            </td>
            <td colspan="3">
              {{lmObject.sessionTitle}}
            </td>
            <td>
              {{#if lmObject.firstOfferingDate}}
                {{moment-format lmObject.firstOfferingDate "L"}}
              {{else}}
                {{t "general.none"}}
              {{/if}}
            </td>
          </tr>
        {{else}}
          <tr>
            <td colspan="9" align="center">
              {{if
                this.sessionQuery
                (t "general.noResultsFound")
                (t "general.noSessionLearningMaterialsAvailable")
              }}
            </td>
          </tr>
        {{/each}}
      {{/if}}
    </tbody>
  </table>
</div>
