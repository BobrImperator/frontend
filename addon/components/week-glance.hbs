<div
  class="week-glance"
  data-test-week-glance
  {{did-insert (perform this.load) @week @year}}
  {{did-update (perform this.load) @week @year}}
>
  <h2 class="title" {{! template-lint-disable}}
    class="{{if @collapsible "clickable collapsible"}}
    {{if @collapsed "collapsed" "expanded"}}"
    role={{if @collapsible "button"}}
    data-test-week-title
    {{on "click" (fn (optional @toggleCollapsed) @collapsed)}}
  >
    {{this.title}}
    {{#if @showFullTitle}}
      {{t "general.weekAtAGlance"}}
    {{/if}}
  </h2>
  {{#liquid-unless @collapsed class="vertical"}}
    {{#unless this.load.isRunning}}
      <div class="ilm-pre-work">
        {{#if (gt this.ilmPreWork.length 0)}}
          <h4>
            {{t "general.preWork"}}
          </h4>
          {{#each this.ilmPreWork as |ilmGroup|}}
            <WeekGlancePreWork @events={{ilmGroup}} />
          {{/each}}
        {{/if}}
      </div>
      {{#if (gt this.nonIlmPreWorkEvents.length 0)}}
        {{#each this.nonIlmPreWorkEvents as |event|}}
          <WeekGlanceEvent @event={{event}} />
        {{/each}}
      {{else}}
        <p>
          {{t "general.none"}}
        </p>
      {{/if}}
    {{else}}
      <p>
        <FaIcon @icon="spinner" @spin={{true}} />
        {{t "general.loadingEvents"}}
      </p>
    {{/unless}}
  {{/liquid-unless}}
</div>
