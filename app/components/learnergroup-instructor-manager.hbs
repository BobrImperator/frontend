<div
  class="learnergroup-instructor-manager"
  {{did-insert (perform this.load) @learnerGroup}}
  {{did-update (perform this.load) @learnerGroup}}
  data-test-learnergroup-instructor-manager
>
  {{#unless this.load.isRunning}}
    <div class="detail-header">
      <div class="title">
        {{t "general.defaultInstructors"}}
      </div>
      {{#if this.isManaging}}
        <div class="actions">
          <button type="button" class="bigadd" {{action (perform this.saveChanges)}}>
            <FaIcon
              @icon={{if this.saveChanges.isRunning "spinner" "check"}}
              @spin={{if this.saveChanges.isRunning true false}}
            />
          </button>
          <button type="button" class="bigcancel" {{ on "click" (set this.isManaging false)}}>
            <FaIcon @icon="undo" />
          </button>
        </div>
      {{else}}
        {{#if @canUpdate}}
          <button type="button" {{on "click" (set this.isManaging true)}}>
            {{t "general.instructorsManageTitle"}}
          </button>
        {{/if}}
      {{/if}}
    </div>
    <div class="detail-content">
      {{#if this.isManaging}}
        <ul class="removable-instructors">
          {{#each (sort-by "fullName" this.instructors) as |user|}}
            <li role="button" {{on "click" (fn this.removeInstructor user)}}>
              <UserNameInfo @user={{user}} />
              <FaIcon @icon="times" class="remove" />
            </li>
          {{/each}}
          {{#each (sort-by "title" this.instructorGroups) as |instructorGroup|}}
            <li role="button" {{on "click" (fn this.removeInstructorGroup instructorGroup)}}>
              {{instructorGroup.title}}
              <FaIcon @icon="times" class="remove" />
            </li>
          {{/each}}
        </ul>
        <UserSearch
          @addUser={{this.addInstructor}}
          @addInstructorGroup={{this.addInstructorGroup}}
          @currentlyActiveUsers={{this.instructors}}
          @availableInstructorGroups={{this.availableInstructorGroups}}
          @currentlyActiveInstructorGroups={{this.instructorGroups}}
        />
      {{else}}
        {{#if (get (await @learnerGroup.allInstructors) "length")}}
          <ul class="assigned-instructors" data-test-assigned-instructors>
            {{#each (sort-by "fullName" (await @learnerGroup.allInstructors)) as |instructor|}}
              <li>
                <UserNameInfo @user={{instructor}} />
              </li>
            {{/each}}
          </ul>
        {{else}}
          <span>
            {{t "general.none"}}
          </span>
        {{/if}}
      {{/if}}
    </div>
  {{/unless}}
</div>
