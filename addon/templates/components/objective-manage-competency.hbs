{{! template-lint-disable attribute-indentation }}
<div class="objectivetitle">
  {{! template-lint-disable no-triple-curlies }}
  {{{this.objective.title}}}
</div>
{{#if (gt (get (await this.competencies) "length") 0)}}
  <ul class="parent-picker">
    {{#each (sort-by "title" (await this.domains)) as |domain|}}
      {{#if (contains domain.id (map-by "id" (await this.domainsWithNoChildren)))}}
        <li
          class="competency-title
            {{if (eq domain.id this.objective.competency.id) "selected"}}"
        >
          <h5>
            {{#if (eq domain.id this.objective.competency.id)}}
              <input
                type="checkbox"
                checked=""
                {{action "removeCurrentCompetency" domain}}
              >
              <span
                class="clickable"
                role="button"
                {{action "removeCurrentCompetency" domain}}
              >
                {{domain.title}}
              </span>
            {{else}}
              <input type="checkbox" {{action "changeCompetency" domain}}>
              <span
                class="clickable"
                role="button"
                {{action "changeCompetency" domain}}
              >
                {{domain.title}}
              </span>
            {{/if}}
          </h5>
        </li>
      {{else}}
        <li>
          <h5
            class="competency-title
              {{if
                (contains
                  domain.id
                  (map-by "id" (await this.competenciesWithSelectedChildren))
                )
                "selected"
              }}"
          >
            {{domain.title}}
          </h5>
          <ul>
            {{#each (sort-by "title" (await domain.children)) as |competency|}}
              {{#if (contains competency.id (map-by "id" (await this.competencies)))}}
                <li
                  class="competency-title
                    {{if (eq competency.id this.objective.competency.id) "selected"}}"
                >
                  {{#if (eq competency.id this.objective.competency.id)}}
                    <input
                      type="checkbox"
                      checked=""
                      {{action "removeCurrentCompetency" competency}}
                    >
                    <span
                      class="clickable"
                      role="button"
                      {{action "removeCurrentCompetency" competency}}
                    >
                      {{competency.title}}
                    </span>
                  {{else}}
                    <input
                      type="checkbox"
                      {{action "changeCompetency" competency}}
                    >
                    <span
                      class="clickable"
                      role="button"
                      {{action "changeCompetency" competency}}
                    >
                      {{competency.title}}
                    </span>
                  {{/if}}
                </li>
              {{/if}}
            {{/each}}
          </ul>
        </li>
      {{/if}}
    {{/each}}
  </ul>
{{else}}
  <div class="no-group">
    <p>
      {{t "general.missingCompetenciesMessage"}}
    </p>
  </div>
{{/if}}
