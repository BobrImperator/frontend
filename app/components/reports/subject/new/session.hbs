<div data-test-reports-subject-new-session>
  <p data-test-year>
    <label>
      {{t "general.in"}}
    </label>
    {{#if this.isLoaded}}
      <select
        aria-label={{t "general.year"}}
        data-test-report-academic-years
      {{on "change" (pick "target.value" this.changeSelectedYear)}}
      >
        <option selected={{is-empty this.selectedYear}} value="">
          {{t "general.allAcademicYears"}}
        </option>
        {{#each
          (sort-by
            "title:desc" this.filteredYears
          ) as |year|
        }}
          <option
            selected={{eq year.id this.selectedYear}}
            value={{year.id}}
          >
            {{year.title}}
          </option>
        {{/each}}
      </select>
    {{else}}
      <LoadingSpinner />
    {{/if}}
  </p>

  <p data-test-session>
    <label for="new-session">
      {{t "general.whichIs"}}
    </label>
    {{#if this.isLoaded}}
      <select
        id="new-session"
        data-test-prepositional-objects
        {{on "change" (pick "target.value" @changeId)}}
        {{did-insert (perform this.setInitialValue)}}
        {{did-update (perform this.setInitialValue) @school}}
      >
        {{#each this.sortedSessions as |session|}}
          <option
            selected={{eq session.id @currentId}}
            value={{session.id}}
          >
            {{#unless this.selectedYear}}
              {{session.course.year}} |&nbsp;
            {{/unless}}
            {{session.title}}
            {{#if session.course.externalId}}
              [{{session.course.externalId}}] |
            {{/if}}
            {{session.course.title}}
          </option>
        {{/each}}
      </select>
    {{else}}
      <LoadingSpinner />
    {{/if}}
  </p>
</div>
