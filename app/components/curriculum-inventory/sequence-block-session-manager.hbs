<section
  class="curriculum-inventory-sequence-block-session-manager resultslist"
  data-test-curriculum-inventory-sequence-block-session-manager
  ...attributes
  {{did-insert (perform this.load)}}
  {{did-update (perform this.load) @sessions}}
>
  {{#unless this.load.isRunning}}
    <div class="actions">
      <button type="button" class="bigadd" {{on "click" (perform this.saveChanges)}}>
        <FaIcon
          @icon={{if this.saveChanges.isRunning "spinner" "check"}}
          @spin={{if this.saveChanges.isRunning true false}}
        />
      </button>
      <button type="button" class="bigcancel" {{on "click" this.close}}>
        <FaIcon @icon="undo" />
      </button>
    </div>
    <div class="list">
      <table>
        <thead>
          <tr>
            <th class="text-center count-as-one-header" colspan="2">
              <input
                type="checkbox"
                checked={{this.allSelected}}
                indeterminate={{this.someSelected}}
                {{on "click" (pick "target.value" this.toggleSelectAll)}}
              >
              {{t "general.countAsOneOffering"}}
            </th>
            <th class="text-center count-as-one-header" colspan="2">
              <input
                type="checkbox"
                checked={{this.allExcluded}}
                indeterminate={{this.someExcluded}}
                {{on "click" (pick "target.value" this.toggleExcludeAll)}}
              >
              {{t "general.exclude"}}
            </th>
            <SortableTh
              @colspan={{3}}
              @click={{fn this.changeSortOrder "title"}}
              @sortedBy={{or (eq @sortBy "title") (eq @sortBy "title:desc")}}
              @sortedAscending={{this.sortedAscending}}
            >
              {{t "general.sessionTitle"}}
            </SortableTh>
            <SortableTh
              @colspan={{3}}
              @click={{fn this.changeSortOrder "sessionType.title"}}
              @sortedBy={{or
                (eq @sortBy "sessionType.title")
                (eq @sortBy "sessionType.title:desc")
              }}
              @sortedAscending={{this.sortedAscending}}
            >
              {{t "general.sessionType"}}
            </SortableTh>
            <th class="text-center" colspan="1">
              {{t "general.totalTime"}}
            </th>
            <SortableTh
              @colspan={{1}}
              @click={{fn this.changeSortOrder "offerings.length"}}
              @sortedBy={{or
                (eq @sortBy "offerings.length")
                (eq @sortBy "offerings.length:desc")
              }}
              @sortedAscending={{this.sortedAscending}}
              @sortType="numeric"
            >
              {{t "general.offerings"}}
            </SortableTh>
          </tr>
        </thead>
        <tbody>
          {{#each (sort-by @sortBy this.sessions) as |session|}}
            <tr>
              <td class="text-center" colspan="2">
                <Input
                  @type="checkbox"
                  @checked={{includes session this.linkedSessions}}
                  {{on "change" (fn this.changeSession session)}}
                />
              </td>
              <td class="text-center" colspan="2">
                <Input
                  @type="checkbox"
                  @checked={{includes session this.excludedSessions}}
                  {{on "change" (fn this.excludeSession session)}}
                />
              </td>
              <td class="text-left" colspan="3">
                {{#if session.isIndependentLearning}}
                  <strong>
                    ({{t "general.ilm"}})
                  </strong>
                {{/if}}
                {{session.title}}
              </td>
              <td class="text-left" colspan="3">
                {{#if (is-pending session.sessionType)}}
                  <LoadingSpinner />
                {{else}}
                  {{get (await session.sessionType) "title"}}
                {{/if}}
              </td>
              <td class="text-center" colspan="1">
                {{#if (includes session this.linkedSessions)}}
                  {{#if (is-pending session.maxDuration)}}
                    <LoadingSpinner />
                  {{else}}
                    {{await session.maxDuration}}
                  {{/if}}
                {{else}}
                  {{#if (is-pending session.totalSumDuration)}}
                    <LoadingSpinner />
                  {{else}}
                    {{await session.totalSumDuration}}
                  {{/if}}
                {{/if}}
              </td>
              <td class="text-center" colspan="1">
                {{#if (is-pending session.offerings)}}
                  <LoadingSpinner />
                {{else}}
                  {{get (await session.offerings) "length"}}
                {{/if}}
              </td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  {{/unless}}
</section>
