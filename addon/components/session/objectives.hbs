<section
  class="detail-objectives {{if this.showCollapsible "collapsible"}}"
  data-test-session-objectives
  {{did-insert (perform this.load) @session @session.course.sortedObjectives}}
  {{did-update (perform this.load) @session @session.course.sortedObjectives}}
>
  <div class="detail-objectives-header">
    {{#if this.isManaging}}
      <div class="title">
        {{#if this.isManagingParents}}
          <span class="specific-title">
            {{t "general.objectiveParentTitleSingular"}}
          </span>
        {{/if}}
        {{#if this.isManagingDescriptors}}
          <span class="specific-title">
            {{t "general.objectiveDescriptorTitle"}}
          </span>
        {{/if}}
      </div>
    {{else}}
      <div
        class="title {{if this.showCollapsible "clickable collapsible"}}"
        role="button"
        {{on "click" this.collapse}}
      >
        {{t "general.objectives"}} ({{@session.objectives.length}})
      </div>
    {{/if}}
    <div class="detail-objectives-actions" data-test-actions>
      {{#if this.isManaging}}
        <button
          type="button"
          class="bigadd"
          {{on "click" (perform this.save)}}
          aria-label={{t "general.save"}}
          data-test-save
        >
          <FaIcon @icon="check" />
        </button>
        <button
          type="button"
          class="bigcancel"
          {{on "click" this.cancel}}
          aria-label={{t "general.cancel"}}
          data-test-cancel
        >
          <FaIcon @icon="undo" />
        </button>
      {{else if @editable}}
        <ExpandCollapseButton
          @value={{this.newObjectiveEditorOn}}
          @action={{this.toggleNewObjectiveEditor}}
          @expandButtonLabel={{t "general.addNew"}}
        />
      {{/if}}
    </div>
  </div>
  <div class="detail-objectives-content">
    {{#if this.newObjectiveEditorOn class="vertical"}}
      <NewObjective
        @save={{perform this.saveNewObjective}}
        @cancel={{this.toggleNewObjectiveEditor}}
      />
    {{/if}}
    {{#unless this.isManaging}}
      <SessionObjectiveList
        @session={{@session}}
        @editable={{@editable}}
        @manageParents={{perform this.manageParents}}
        @manageDescriptors={{perform this.manageDescriptors}}
      />
    {{else}}
      {{#if this.isManagingParents}}
        <Session::ManageObjectiveParents
          @objective={{this.manageParentsObjective}}
          @courseTitle={{@session.course.title}}
          @courseObjectives={{this.courseObjectives}}
          @selected={{this.parentsBuffer}}
          @add={{this.addParentToBuffer}}
          @remove={{this.removeParentFromBuffer}}
        />
      {{/if}}
      {{#if this.isManagingDescriptors}}
        <Session::ManageObjectiveDescriptors
          @objectiveTitle={{this.manageDescriptorsObjective.title}}
          @selected={{this.descriptorsBuffer}}
          @add={{this.addDescriptorToBuffer}}
          @remove={{this.removeDescriptorFromBuffer}}
          @editable={{@editable}}
        />
      {{/if}}
    {{/unless}}
  </div>
</section>
