{{! template-lint-disable attribute-indentation }}
<div class="selected-learner-groups">
  <h4>
    {{t "general.selectedLearnerGroups"}}
  </h4>
  {{#if this.learnerGroups.length}}
    <DetailLearnergroupsList
      @learnerGroups={{this.learnerGroups}}
      @isManaging={{true}}
      @remove={{this.remove}}
    />
  {{else}}
    <p>
      {{t "general.none"}}
    </p>
  {{/if}}
</div>
<div class="available-learner-groups">
  <h4>
    {{t "general.availableLearnerGroups"}}
    {{#unless (and (is-fulfilled this.allLearnerGroups) (is-fulfilled this.cohorts))}}
      <LoadingSpinner />
    {{/unless}}
  </h4>
  <SearchBox
    @search={{action (mut this.filter)}}
    placeholder={{t "general.filterPlaceholder"}}
  />
  <div class="cohorts-container" data-test-cohorts>
    {{#each (sort-by "title" (await this.cohorts)) as |cohort|}}
      <div class="cohort-learner-groups" data-test-cohort>
        {{#if
          (and
            (is-fulfilled cohort.programYear)
            (is-fulfilled cohort.programYear.program)
            (is-fulfilled cohort.rootLevelLearnerGroups)
          )
        }}
          <h5 class="cohort-title">
            {{cohort.programYear.program.title}}
            {{cohort.title}}
          </h5>
          <ul class="tree-groups-list">
            {{#each
              (sort-by
                "title" (await cohort.rootLevelLearnerGroups)
              ) as |learnerGroup|
            }}
              <LearnergroupTree
                @learnerGroup={{learnerGroup}}
                @selectedGroups={{this.learnerGroups}}
                @filter={{this.filter}}
                @add={{action add}}
              />
            {{/each}}
          </ul>
        {{else}}
          <LoadingSpinner />
        {{/if}}
      </div>
    {{/each}}
  </div>
</div>
